!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(){this.editor=new d,this.iframe=new e,this.imageEditor=new f,this.editor.on("saved",this.onSaved,this),this.editor.on("loaded",this.onTexture,this),this.imageEditor.on("uploaded",this.onUploaded,this)}var d=a("../controllers/JsonEditor"),e=a("../controllers/IFrame"),f=a("../controllers/ImageEditor");c.prototype.constructor=c,c.prototype.init=function(a,b,c,d){this.editor.init(c),this.iframe.init(d,a),this.imageEditor.init(c)},c.prototype.onTexture=function(){this.imageEditor.clearTextures();var a=this.editor.getJson();if(a.graphics&&a.graphics.textures)for(var b=0;b<a.graphics.textures.length;b++)this.imageEditor.addTexture(a.graphics.textures[b]);this.iframe.setResourceURL("http://127.0.0.1:8080/php/textureFiles/bajs/texture.json")},c.prototype.onSaved=function(){console.log("FiddleClient.prototype.onSaved"),this.iframe.reload()},c.prototype.onUploaded=function(a){this.editor.setTextureJson(a),this.iframe.reload()},b.exports=c},{"../controllers/IFrame":2,"../controllers/ImageEditor":3,"../controllers/JsonEditor":4}],2:[function(a,b){function c(){this.url=""}c.prototype.constructor=c,c.prototype.init=function(a,b){this.url=b,this.htmlElement=document.createElement("iframe"),this.htmlElement.style.width="100%",this.htmlElement.style.height="100%",this.htmlElement.setAttribute("src",b),a.appendChild(this.htmlElement)},b.exports=c,c.prototype.reload=function(){console.log("IFrame.prototype.reload");var a=this.url+"?resources="+this.resourceURL+"&____timestamp="+Date.now();this.htmlElement.setAttribute("src",a)},c.prototype.setResourceURL=function(a){this.resourceURL=a;var b=this.url+"?resources="+this.resourceURL;this.htmlElement.setAttribute("src",b)}},{}],3:[function(a,b){function c(){this.container=null,this.images=new Array,this.imageContainer=null,this.uploadButton=null,this.container=null}{var d=a("../utils/EventDispatcher"),e=a("../utils/APIConnection");a("../views/ImageItem")}c.prototype.constructor=c,d.init(c),c.prototype.init=function(){this.uploadButton=document.createElement("input"),this.uploadButton.setAttribute("type","file"),this.uploadButton.setAttribute("value","Upload new image"),this.uploadButton.addEventListener("change",this.onUpload.bind(this)),this.container.appendChild(this.uploadButton),this.imageContainer=document.createElement("div"),this.imageContainer.style.background="#FFFFFF",this.imageContainer.style.width="512px",this.container.appendChild(this.imageContainer)},c.prototype.clearTextures=function(){this.imageContainer.innerHTML=""},c.prototype.addTexture=function(a){this.imageContainer.innerHTML="";var b=document.createElement("div");b.innerHTML="textureId: "+a.id,this.imageContainer.appendChild(b);var c=document.createElement("img");c.style.width="512px",c.style.height="512px",c.setAttribute("src",a.file+"?__timestamp___="+Date.now()),this.imageContainer.appendChild(c)},c.prototype.loadImages=function(){var a=new e;a.on("loaded",this.onImages,this),a.load("getImages",{session:"bajs"})},c.prototype.onUpload=function(){if(this.uploadButton.files.length>0){var a=new FormData;a.append("SelectedFile",this.uploadButton.files[0]);var b=new e;b.on("loaded",this.onUploaded,this),b.upload("upload",a)}else console.warn("No files selected: this.uploadButton:",this.uploadButton)},c.prototype.onImages=function(a){a.connection.off("loaded",this.onImages,this),this.images=a.json.data,this.imageContainer.innerHTML="";for(var b=0;b<this.images.length;b++){var c=document.createElement("li"),d=document.createElement("img");d.setAttribute("src","php/"+this.images[b]),c.appendChild(d),this.imageContainer.appendChild(c)}},c.prototype.onUploaded=function(a){var b=(a.connection,a.json);console.log("json = ",JSON.stringify(b)),this.trigger("uploaded",b)},b.exports=c},{"../utils/APIConnection":6,"../utils/EventDispatcher":8,"../views/ImageItem":9}],4:[function(a,b){function c(){this.htmlElement=null,this.sendButton=null,this.iFrame=null,this.altDown=!1,this.json={}}var d=a("../utils/EventDispatcher"),e=a("../utils/APIConnection");c.prototype.constructor=c,d.init(c),c.prototype.init=function(a){this.container=a,this.htmlElement=document.createElement("textarea"),this.htmlElement.style.width="100%",this.htmlElement.style.minHeight="50%",this.htmlElement.style.maxHeight="80%",this.container.appendChild(this.htmlElement),this.htmlElement.addEventListener("keyup",this.onKeyUp.bind(this)),this.htmlElement.addEventListener("keydown",this.onKeyDown.bind(this)),this.sendButton=document.createElement("input"),this.sendButton.setAttribute("type","button"),this.sendButton.setAttribute("value","Save"),this.sendButton.addEventListener("click",this.onSave.bind(this)),this.container.appendChild(this.sendButton);var b=new e;b.on("loaded",this.onTexture,this),b.load("getTexture",{session:"bajs"})},c.prototype.setTextureJson=function(a){this.json=JSON.parse(this.htmlElement.value),console.log("document.location = "+document.location);for(var b=0;b<a.textures.length;b++)a.textures[b].file=document.location+"php/"+a.textures[b].file;this.json.graphics=a,this.htmlElement.value=this.beautify(this.json),this.onSave()},c.prototype.getJson=function(){try{this.json=JSON.parse(this.htmlElement.value)}catch(a){console.warn("failed to parse json in JsonEditor.prototype.getJson. Error: ",a)}return this.json},c.prototype.onSave=function(){try{var a=(JSON.parse(this.htmlElement.value),new e);a.on("loaded",this.onSaved,this),a.load("save",{session:"bajs",json:this.htmlElement.value})}catch(b){alert("Invalid json")}},c.prototype.onTexture=function(a){var b=a.connection,c=a.json;b.off("loaded",this.onTexture,this),this.json=c,this.htmlElement.value=this.beautify(this.json),console.log("onTexture, json = ",this.json),this.trigger("loaded")},c.prototype.onSaved=function(a){var b=a.connection,c=a.json;b.off("loaded",this.onSaved,this),console.log("onSaved, json = ",c),this.trigger("saved")},c.prototype.onKeyUp=function(a){switch(a.keyCode){case 91:this.altDown=!1}},c.prototype.onKeyDown=function(a){switch(a.keyCode){case 9:this.insertAtCursor("	"),a.preventDefault();break;case 91:this.altDown=!0;break;case 83:1==this.altDown&&(a.preventDefault(),this.onSave())}},c.prototype.insertAtCursor=function(a){if(console.log("this.htmlElement.selectionStart = "+this.htmlElement.selectionStart),document.selection)this.htmlElement.focus(),sel=document.selection.createRange(),sel.text=a;else if(this.htmlElement.selectionStart||"0"==this.htmlElement.selectionStart){var b=this.htmlElement.selectionStart,c=this.htmlElement.selectionEnd;this.htmlElement.value=this.htmlElement.value.substring(0,b)+a+this.htmlElement.value.substring(c,this.htmlElement.value.length),this.htmlElement.selectionStart=c+1,this.htmlElement.selectionEnd=c+1}else this.htmlElement.value+=a},String.prototype.splice=function(a,b,c){return this.slice(0,a)+c+this.slice(a+Math.abs(b))},c.prototype.insertTabs=function(a){0>a&&(a=0);for(var b="",c=0;a>c;c++)b+="	";return b},c.prototype.beautify=function(a){for(var b=JSON.stringify(a),c=0,d=0;d<b.length;d++)switch(b[d]){case"[":case"{":c++,b=b.splice(d+1,0,"\n"+this.insertTabs(c));break;case"}":case"]":c--,b=b.splice(d,0,"\n"+this.insertTabs(c)),d+=1+c;break;case",":b=b.splice(d+1,0,"\n"+this.insertTabs(c));break;case":":}return b},b.exports=c},{"../utils/APIConnection":6,"../utils/EventDispatcher":8}],5:[function(a){FiddleClient=a("./app/FiddleClient")},{"./app/FiddleClient":1}],6:[function(a,b){function c(){this.url="php/?__route__=/",this.session="bajs"}var d=a("./EventDispatcher");d.init(c),c.prototype.load=function(a,b){var c=null;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.onreadystatechange=this.onReadyStateChange.bind(this,c);var d=this.url+a+"&session="+this.session,e="",f=!0;for(var g in b)f?f=!1:e+="&",e+=g+"="+b[g];e+="&___timestamp____="+Date.now(),c.open("POST",d,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.send(e)},c.prototype.upload=function(a,b){var c=null;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.onreadystatechange=this.onReadyStateChange.bind(this,c);var d=this.url+a+"&session="+this.session;c.open("POST",d,!0),c.send(b)},c.prototype.onReadyStateChange=function(a){if(4==a.readyState)if(200==a.status||-1==window.location.href.indexOf("http")){var b=JSON.parse(a.response);this.trigger("loaded",{connection:this,json:b})}else console.log("An error has occured making the request")},b.exports=c},{"./EventDispatcher":8}],7:[function(a,b){function c(){}c.extends=function(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a},b.exports=c},{}],8:[function(a,b){"use strict";function c(){this.listenerMap={}}c.prototype.addEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),!a)throw new Error("Event type required for event dispatcher");if(!b)throw new Error("Listener required for event dispatcher");this.removeEventListener(a,b,c),this.listenerMap.hasOwnProperty(a)||(this.listenerMap[a]=[]),this.listenerMap[a].push({listener:b,scope:c})},c.prototype.removeEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),this.listenerMap.hasOwnProperty(a)){for(var d=this.listenerMap[a],e=0;e<d.length;e++){var f=d[e];b==f.listener&&c==f.scope&&(d.splice(e,1),e--)}d.length||delete this.listenerMap[a]}},c.prototype.dispatchEvent=function(a,b){if(this.listenerMap||(this.listenerMap={}),"string"==typeof a&&(a={type:a}),this.listenerMap.hasOwnProperty(a.type)){void 0==b&&(b=a);for(var c in this.listenerMap[a.type]){var d=this.listenerMap[a.type][c];d.listener.call(d.scope,b)}}},c.prototype.on=c.prototype.addEventListener,c.prototype.off=c.prototype.removeEventListener,c.prototype.trigger=c.prototype.dispatchEvent,c.init=function(a){a.prototype.addEventListener=c.prototype.addEventListener,a.prototype.removeEventListener=c.prototype.removeEventListener,a.prototype.dispatchEvent=c.prototype.dispatchEvent,a.prototype.on=c.prototype.on,a.prototype.off=c.prototype.off,a.prototype.trigger=c.prototype.trigger},b.exports=c},{}],9:[function(a,b){function c(a){this.name=a.name,this.image=null,this.uploadButton=null}var d=a("../utils/ClassUtils"),e=a("./ListItem");d.extend(c,e),b.exports=c},{"../utils/ClassUtils":7,"./ListItem":10}],10:[function(a,b){function c(){}b.exports=c},{}]},{},[5]);